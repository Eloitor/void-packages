# Template file for 'uxn'
pkgname=uxn
version=1.0
revision=1
hostmakedepends="SDL2-devel"
makedepends="SDL2-devel"
short_desc="Assembler and emulator for the Uxn stack-machine"
maintainer="Eloi Torrents <eloitor@duck.com>"
license="MIT"
homepage="https://100r.co/site/uxn.html"
distfiles="https://git.sr.ht/~rabbits/uxn/archive/${version}.tar.gz"
checksum=29059ee288474e48fae4b9e755bbc8e1b392a9c7ac90449d7a6599385c145460

do_build() {
	mkdir -p bin
	export UXNEMU_LDFLAGS="-L/usr/local/lib $(sdl2-config --cflags --libs)"
	${CC} ${CFLAGS} src/uxnasm.c -o bin/uxnasm
	${CC} ${CFLAGS} src/uxn.c src/devices/system.c src/devices/console.c src/devices/file.c src/devices/datetime.c src/devices/mouse.c src/devices/controller.c src/devices/screen.c src/devices/audio.c src/uxnemu.c ${UXNEMU_LDFLAGS} -o bin/uxnemu
	${CC} ${CFLAGS} src/uxn.c src/devices/system.c src/devices/console.c src/devices/file.c src/devices/datetime.c src/uxncli.c ${UXNEMU_LDFLAGS} -o bin/uxncli
}

do_install() {
	vbin bin/uxnasm
	vbin bin/uxncli
	vbin bin/uxnemu
	vlicense LICENSE
}
